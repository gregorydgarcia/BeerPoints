var BP=BP,turf=turf,L=L,markers=new L.MarkerClusterGroup;BP.assignPop=function(e,a){a.bindPopup("<div class='popup'> <span class='rank'> "+e.properties.rank+"</span><span class='name'> <a href='http://www.beeradvocate.com/"+e.properties.link+"' target='_blank'>"+e.properties.name+"</a> </span><span class='brewery'> "+e.properties.brewery+"</span><span class='location'> "+e.properties.location+"</span></div>")},BP.getColor=function(e){return e>15?"#ff9042":e>10?"#ff9f42":e>7?"#ffda42":e>5?"#ffbf42":e>3?"#ffcf42":e>0?"#ffde42":"#FFFFF0"},BP.style=function(e){return{fillColor:BP.getColor(e.properties.sum),weight:2,opacity:1,color:"white",dashArray:"3",fillOpacity:.7}},BP.togglePoints=function(e){markers=new L.MarkerClusterGroup,BP.toggleRef=L.geoJson(BP.styles[e],{onEachFeature:BP.assignPop,pointToLayer:function(e,a){return L.marker(a,{icon:BP.beerIcon})}}),markers.addLayer(BP.toggleRef),BP.map.addLayer(markers)},BP.toggleState=function(e){BP.map.removeLayer(BP.statesRef),BP.turf=turf.count(BP.statesData,BP.styles[e],"sum"),BP.statesRef=L.geoJson(BP.turf,{style:BP.style}).addTo(BP.map)},BP.map=L.map("map",{center:[40,-98],zoom:4,maxZoom:7}),BP.tiles=new L.tileLayer("http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png").addTo(BP.map),BP.statesRef=L.geoJson(BP.statesData),BP.beerIcon=L.AwesomeMarkers.icon({prefix:"ion",markerColor:"orange",icon:"beer"}),BP.togglePoints("IPA"),BP.toggleState("IPA"),$("nav a").on("click",function(){BP.map.removeLayer(markers),$(".active").removeClass("active"),$(this).addClass("active");var e=$(this).attr("id");BP.togglePoints(e),BP.toggleState(e)});